book
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_5 <- get_map(location = c(lon = 121.8, lat = 25.18), zoom = 10)
ggmap(map_5) + geom_point(aes(x = lon, y = lat), data = bs)
library(reader)
book
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_5 <- get_map(location = c(lon = 121.8, lat = 25.18), zoom = 20)
ggmap(map_5) + geom_point(aes(x = lon, y = lat), data = bs)
library(reader)
book
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_5 <- get_map(location = c(lon = 121.8, lat = 25.18), zoom = 15)
ggmap(map_5) + geom_point(aes(x = lon, y = lat), data = bs)
library(reader)
book
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_5 <- get_map(location = c(lon = 121.564472, lat = 25.033964), zoom = 15)
ggmap(map_5) + geom_point(aes(x = lon, y = lat), data = bs)
library(reader)
book
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_5 <- get_map(location = c(lon = 121.576957, lat = 25.028702), zoom = 15)
ggmap(map_5) + geom_point(aes(x = lon, y = lat), data = bs)
library(reader)
book
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_5 <- get_map(location = c(lon = 121.576957, lat = 25.028702), zoom = 15)
ggmap(map_5) + geom_point(aes(x = lon, y = lat), data = bs)
ggmap(map_5, darken = c(0.5, "white")) +
geom_point(aes(x = lon, y = lat), data = bs)
library(reader)
book
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_5 <- get_map(location = c(lon = 121.576957, lat = 25.028702), zoom = 15)
ggmap(map_5) + geom_point(aes(x = lon, y = lat), data = bs)
library(reader)
book
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_5 <- get_map(location = c(lon = 121.534696, lat =25.013682), zoom = 15)
ggmap(map_5) + geom_point(aes(x = lon, y = lat), data = bs)
library(reader)
book
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_6 <- get_map(location = c(lon = 121.534696, lat =25.013682), zoom = 18)
ggmap(map_6) + geom_point(aes(x = lon, y = lat), data = bs)
library(reader)
book
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_6 <- get_map(location = c(lon = 121.534696, lat =25.013682), zoom = 16)
ggmap(map_6) + geom_point(aes(x = lon, y = lat), data = bs)
library(reader)
book
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_6 <- get_map(location = c(lon = 121.534696, lat =25.013682), zoom = 15)
ggmap(map_6) + geom_point(aes(x = lon, y = lat), data = bs)
library(reader)
book
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_6 <- get_map(location = c(lon = 121.534696, lat =25.013682), zoom = 14)
ggmap(map_6) + geom_point(aes(x = lon, y = lat), data = bs)
library(reader)
book
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_6 <- get_map(location = c(lon = 121.534696, lat =25.013682), zoom = 15)
ggmap(map_6) + geom_point(aes(x = lon, y = lat), data = bs)
library(readr)
book
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_4 <- get_map(location = c(lon = 120.5, lat = 23.625), zoom = 8)
ggmap(map_4) + geom_point(aes(x = lon, y = lat), data = bs)
library(readr)
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_5 <- get_map(location = c(lon = 121.542709, lat = 25.026158), zoom = 15)
ggmap(map_5) + geom_point(aes(x = lon, y = lat), data = bs)
library(readr)
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_6 <- get_map(location = c(lon = 121.519872, lat =25.042141), zoom = 15)
ggmap(map_6) + geom_point(aes(x = lon, y = lat), data = bs)
library(readr)
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)ˇ
library(readr)
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_6 <- get_map(location = c(lon = 121.519872, lat =25.042141), zoom = 13)
ggmap(map_6) + geom_point(aes(x = lon, y = lat), data = bs)
library(readr)
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_6 <- get_map(location = c(lon = 121.519872, lat =25.042141), zoom = 13)
ggmap(map_6) + geom_point(aes(x = lon, y = lat), data = bs)
library(readr)
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_6 <- get_map(location = c(lon = 120.673648, lat =24.147736), zoom = 10)
ggmap(map_6) + geom_point(aes(x = lon, y = lat), data = bs)
library(readr)
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_6 <- get_map(location = c(lon = 120.673648, lat =24.147736), zoom = 13)
ggmap(map_6) + geom_point(aes(x = lon, y = lat), data = bs)
library(readr)
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_6 <- get_map(location = c(lon = 120.673648, lat =24.147736), zoom = 14)
ggmap(map_6) + geom_point(aes(x = lon, y = lat), data = bs)
library(readr)
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_6 <- get_map(location = c(lon = 120.673648, lat =24.147736), zoom = 12)
ggmap(map_6) + geom_point(aes(x = lon, y = lat), data = bs)
library(readr)
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_6 <- get_map(location = c(lon = 120.673648, lat =24.147736), zoom = 13)
ggmap(map_6) + geom_point(aes(x = lon, y = lat), data = bs)
library(readr)
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_6 <- get_map(location = c(lon = 120.673648, lat =24.147736), zoom = 14)
ggmap(map_6) + geom_point(aes(x = lon, y = lat), data = bs)
library(readr)
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_6 <- get_map(location = c(lon = 120.673648, lat =24.147736), zoom = 14)
ggmap(map_6) + geom_point(aes(x = lon, y = lat), data = bs)
my.lat <- c(24.145685, 24.177765, 24.156164 , 24.156164, 24.150739, 24.136948, 24.142795, 24.142762, 24.150957, 24.150957, 24.150957, 24.188549, 24.044294)
my.lon <- c(120.682090, 120.700125, 120.666303, 120.666303, 120.662417
, 120.663741, 120.673751, 120.659241, 120.664047, 120.664047, 120.664047, 120.593548, 120.73499)
bb = qbbox(my.lat, my.lon)
library(readr)
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_6 <- get_map(location = c(lon = 120.673648, lat =24.147736), zoom = 14)
ggmap(map_6) + geom_point(aes(x = lon, y = lat), data = bs)
my.lat <- c(24.145685, 24.177765, 24.156164 , 24.156164, 24.150739, 24.136948, 24.142795, 24.142762, 24.150957, 24.150957, 24.150957, 24.188549, 24.044294)
my.lon <- c(120.682090, 120.700125, 120.666303, 120.666303, 120.662417
, 120.663741, 120.673751, 120.659241, 120.664047, 120.664047, 120.664047, 120.593548, 120.73499)
bb <- qbbox(my.lat, my.lon)
library(readr)
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_6 <- get_map(location = c(lon = 120.673648, lat =24.147736), zoom = 14)
ggmap(map_6) + geom_point(aes(x = lon, y = lat), data = bs)
my.lat <- c(24.145685, 24.177765, 24.156164 , 24.156164, 24.150739, 24.136948, 24.142795, 24.142762, 24.150957, 24.150957, 24.150957, 24.188549, 24.044294)
my.lon <- c(120.682090, 120.700125, 120.666303, 120.666303, 120.662417
, 120.663741, 120.673751, 120.659241, 120.664047, 120.664047, 120.664047, 120.593548, 120.73499)
b_b <- qbbox(my.lat, my.lon)
library(readr)
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_6 <- get_map(location = c(lon = 120.673648, lat =24.147736), zoom = 14)
ggmap(map_6) + geom_point(aes(x = lon, y = lat), data = bs)
my.lat <- c(24.145685, 24.177765, 24.156164 , 24.156164, 24.150739, 24.136948, 24.142795, 24.142762, 24.150957, 24.150957, 24.150957, 24.188549, 24.044294)
my.lon <- c(120.682090, 120.700125, 120.666303, 120.666303, 120.662417
, 120.663741, 120.673751, 120.659241, 120.664047, 120.664047, 120.664047, 120.593548, 120.73499)
bs <- qbbox(my.lat, my.lon)
install.packages("qbbox")
tw <- get_map(location = c(lon = 120.5, lat = 23.625), zoom = 8)
overlay <- stat_density2d(aes(x = lon, y = lat, fill = ..level.., alpha = ..level..), bins = 4, geom = "polygon", data = bs)
tw +
stat_density2d(aes(x = lon, y = lat, fill = ..level.., alpha = ..level..),
bins = 4, geom = "polygon", data = bs) +
scale_fill_gradient("點閱數") +
scale_alpha(range = c(.4, .75), guide = FALSE) +
guides(fill = guide_colorbar(barwidth = 1.5, barheight = 10)) +
inset(
grob = ggplotGrob(ggplot() + overlay +
scale_fill_gradient("點閱數") +
scale_alpha(range = c(.4, .75), guide = FALSE) +
theme_inset()
),
xmin = attr(tw,"bb")$ll.lon +
(7/10) * (attr(tw,"bb")$ur.lon - attr(tw,"bb")$ll.lon),
xmax = Inf,
ymin = -Inf,
ymax = attr(tw,"bb")$ll.lat +
(3/10) * (attr(tw,"bb")$ur.lat - attr(tw,"bb")$ll.lat)
)
ibrary(readr)
library(readr)
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_4 <- get_map(location = c(lon = 120.5, lat = 23.625), zoom = 8)
ggmap(map_4) + geom_point(aes(x = lon, y = lat, size = "點閱數"), data = bs)
tw <- get_map(location = c(lon = 120.5, lat = 23.625), zoom = 8)
overlay <- stat_density2d(aes(x = lon, y = lat, fill = ..level.., alpha = ..level..), bins = 4, geom = "polygon", data = bs)
map_4 +
stat_density2d(aes(x = lon, y = lat, fill = ..level.., alpha = ..level..),
bins = 4, geom = "polygon", data = bs) +
scale_fill_gradient("點閱數") +
scale_alpha(range = c(.4, .75), guide = FALSE) +
guides(fill = guide_colorbar(barwidth = 1.5, barheight = 10)) +
inset(
grob = ggplotGrob(ggplot() + overlay +
scale_fill_gradient("點閱數") +
scale_alpha(range = c(.4, .75), guide = FALSE) +
theme_inset()
),
xmin = attr(tw,"bb")$ll.lon +
(7/10) * (attr(tw,"bb")$ur.lon - attr(tw,"bb")$ll.lon),
xmax = Inf,
ymin = -Inf,
ymax = attr(tw,"bb")$ll.lat +
(3/10) * (attr(tw,"bb")$ur.lat - attr(tw,"bb")$ll.lat)
)
install.packages("stat_density2d")
install.packages("stat_density")
install.packages("stat")
library(readr)
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_4 <- get_map(location = c(lon = 120.5, lat = 23.625), zoom = 8)
ggmap(map_4) + geom_point(aes(x = lon, y = lat, size = "點閱數"), data = bs)
tw <- get_map(location = c(lon = 120.5, lat = 23.625), zoom = 8)
overlay <- stat_density2d(aes(x = lon, y = lat, fill = ..level.., alpha = ..level..), bins = 4, geom = "polygon", data = bs)
map_4 + stat_density2d(aes(x = lon, y = lat, fill = ..level.., alpha = ..level..),
bins = 4, geom = "polygon", data = bs) +
scale_fill_gradient("點閱數") +
scale_alpha(range = c(.4, .75), guide = FALSE) +
guides(fill = guide_colorbar(barwidth = 1.5, barheight = 10)) +
inset(
grob = ggplotGrob(ggplot() + overlay +
scale_fill_gradient("點閱數") +
scale_alpha(range = c(.4, .75), guide = FALSE) +
theme_inset()
),
xmin = attr(tw,"bb")$ll.lon +
(7/10) * (attr(tw,"bb")$ur.lon - attr(tw,"bb")$ll.lon),
xmax = Inf,
ymin = -Inf,
ymax = attr(tw,"bb")$ll.lat +
(3/10) * (attr(tw,"bb")$ur.lat - attr(tw,"bb")$ll.lat)
)
library(readr)
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_4 <- get_map(location = c(lon = 120.5, lat = 23.625), zoom = 8)
ggmap(map_4) + geom_point(aes(x = lon, y = lat, size = "點閱數"), data = bs)
tw <- get_map(location = c(lon = 120.5, lat = 23.625), zoom = 8)
overlay <- stat_density2d(aes(x = lon, y = lat, fill = ..level.., alpha = ..level..), bins = 4, geom = "polygon", data = bs)
map_4 + overlay + scale_fill_gradient("點閱數") +
scale_alpha(range = c(.4, .75), guide = FALSE) +
guides(fill = guide_colorbar(barwidth = 1.5, barheight = 10)) +
inset(
grob = ggplotGrob(ggplot() + overlay +
scale_fill_gradient("點閱數") +
scale_alpha(range = c(.4, .75), guide = FALSE) +
theme_inset()
),
xmin = attr(tw,"bb")$ll.lon +
(7/10) * (attr(tw,"bb")$ur.lon - attr(tw,"bb")$ll.lon),
xmax = Inf,
ymin = -Inf,
ymax = attr(tw,"bb")$ll.lat +
(3/10) * (attr(tw,"bb")$ur.lat - attr(tw,"bb")$ll.lat)
)
library(readr)
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_4 <- get_map(location = c(lon = 120.5, lat = 23.625), zoom = 8)
ggmap(map_4) + geom_point(aes(x = lon, y = lat, size = "點閱數"), data = bs)
tw <- get_map(location = c(lon = 120.5, lat = 23.625), zoom = 8)
overlay <- stat_density2d(aes(x = lon, y = lat, fill = ..level.., alpha = ..level..), bins = 4, geom = "polygon", data = bs)
map_4 + overlay + scale_fill_gradient("點閱數") + scale_alpha(range = c(.4, .75), guide = FALSE) + guides(fill = guide_colorbar(barwidth = 1.5, barheight = 10)) + inset(grob = ggplotGrob(ggplot() + overlay + scale_fill_gradient("點閱數") + scale_alpha(range = c(.4, .75), guide = FALSE) + theme_inset()),
xmin = attr(tw,"bb")$ll.lon +
(7/10) * (attr(tw,"bb")$ur.lon - attr(tw,"bb")$ll.lon),
xmax = Inf,
ymin = -Inf,
ymax = attr(tw,"bb")$ll.lat +
(3/10) * (attr(tw,"bb")$ur.lat - attr(tw,"bb")$ll.lat)
)
library(readr)
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_4 <- get_map(location = c(lon = 120.5, lat = 23.625), zoom = 8)
ggmap(map_4) + geom_point(aes(x = lon, y = lat, size = "點閱數"), data = bs)
tw <- get_map(location = c(lon = 120.5, lat = 23.625), zoom = 8)
overlay <- stat_density2d(aes(x = lon, y = lat, fill = ..level.., alpha = ..level..), bins = 4, geom = "polygon", data = bs)
map_4 <- overlay + scale_fill_gradient("點閱數") + scale_alpha(range = c(.4, .75), guide = FALSE) + guides(fill = guide_colorbar(barwidth = 1.5, barheight = 10)) + inset(grob = ggplotGrob(ggplot() + overlay + scale_fill_gradient("點閱數") + scale_alpha(range = c(.4, .75), guide = FALSE) + theme_inset()),
xmin = attr(tw,"bb")$ll.lon +
(7/10) * (attr(tw,"bb")$ur.lon - attr(tw,"bb")$ll.lon),
xmax = Inf,
ymin = -Inf,
ymax = attr(tw,"bb")$ll.lat +
(3/10) * (attr(tw,"bb")$ur.lat - attr(tw,"bb")$ll.lat)
)
library(readr)
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_4 <- get_map(location = c(lon = 120.5, lat = 23.625), zoom = 8)
ggmap(map_4) + geom_point(aes(x = lon, y = lat, size = "點閱數"), data = bs)
tw <- get_map(location = c(lon = 120.5, lat = 23.625), zoom = 8)
overlay <- stat_density2d(aes(x = lon, y = lat, fill = ..level.., alpha = ..level..), bins = 4, geom = "polygon", data = bs)
library(readr)
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_4 <- get_map(location = c(lon = 120.5, lat = 23.625), zoom = 8)
ggmap(map_4) + geom_point(aes(x = lon, y = lat, size = "點閱數"), data = bs)
tw <- get_map(location = c(lon = 120.5, lat = 23.625), zoom = 8)
overlay <- stat_density2d(aes(x = lon, y = lat, fill = ..level.., alpha = ..level..), bins = 4, geom = "polygon", data = bs)
map_4 +
stat_density2d(aes(x = lon, y = lat, fill = ..level.., alpha = ..level..),
size = 2, bins = 4, data = bs, geom = "polygon") +
scale_fill_gradient("點閱數") +
scale_alpha(range = c(.4, .75), guide = FALSE) +
guides(fill = guide_colorbar(barwidth = 1.5, barheight = 10))
library(readr)
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_4 <- get_map(location = c(lon = 120.5, lat = 23.625), zoom = 8)
ggmap(map_4) + geom_point(aes(x = lon, y = lat, size = "點閱數"), data = bs)
tw <- get_map(location = c(lon = 120.5, lat = 23.625), zoom = 8)
overlay <- stat_density2d(aes(x = lon, y = lat, fill = ..level.., alpha = ..level..), bins = 4, geom = "polygon", data = bs)
tw +
stat_density2d(aes(x = lon, y = lat, fill = ..level.., alpha = ..level..),
size = 2, bins = 4, data = bs, geom = "polygon") +
scale_fill_gradient("點閱數") +
scale_alpha(range = c(.4, .75), guide = FALSE) +
guides(fill = guide_colorbar(barwidth = 1.5, barheight = 10))
library(readr)
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_4 <- get_map(location = c(lon = 120.5, lat = 23.625), zoom = 8)
ggmap(map_4) + geom_point(aes(x = lon, y = lat, size = "點閱數"), data = bs)
tw <- get_map(location = c(lon = 120.5, lat = 23.625), zoom = 8)
overlay <- stat_density2d(aes(x = lon, y = lat, fill = ..level.., alpha = ..level..), bins = 4, geom = "polygon", data = bs)
tw + stat_density2d(aes(x = lon, y = lat, fill = ..level.., alpha = ..level..),
size = 2, bins = 4, data = bs, geom = "polygon") +
scale_fill_gradient("點閱數") +
scale_alpha(range = c(.4, .75), guide = FALSE) +
guides(fill = guide_colorbar(barwidth = 1.5, barheight = 10))
library(readr)
bs <- read_csv("book.csv")
lon.deg <- sapply((strsplit(as.character(bs$"經度"), ",")), as.numeric)
lat.deg <- sapply((strsplit(as.character(bs$"緯度"), ",")), as.numeric)
bs$lat <- lat.deg
bs$lon <- lon.deg
library(ggmap)
map_4 <- get_map(location = c(lon = 120.5, lat = 23.625), zoom = 8)
ggmap(map_4) + geom_point(aes(x = lon, y = lat, size = "點閱數"), data = bs)
tw <- get_map(location = c(lon = 120.5, lat = 23.625), zoom = 8)
overlay <- stat_density2d(aes(x = lon, y = lat, fill = ..level.., alpha = ..level..), bins = 4, geom = "polygon", scale_fill_gradient("點閱數"), data = bs)
